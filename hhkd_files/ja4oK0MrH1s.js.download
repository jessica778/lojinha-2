if (self.CavalryLogger) { CavalryLogger.start_js(["+frR4"]); }

__d("TagToken",["DOM","Token"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b,"tag")||this}var d=c.prototype;d.createElement=function(){var a=this.isFreeform(),c=b("DOM").create("span",{className:"separator"},", "),d=b("DOM").create(a?"span":"a",{className:"taggee","data-tag":this.getValue()},this.getText());a||(d.href=this.getInfo().path);return b("DOM").create("span",{className:"tagItem"},[c,d])};return c}(b("Token"));e.exports=a}),null);
__d("TagTokenizer",["fbt","Arbiter","CSS","DOM","Parent","TagToken","Tokenizer","createObjectFrom","ge","getElementText"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g){e=a.call(this,e,f,g)||this;b("Arbiter").subscribe("PhotoInlineEditor.CANCEL_INLINE_EDITING",e.updateTokenareaVisibility.bind(babelHelpers.assertThisInitialized(e)),"new");e.appphoto=d;b("Arbiter").subscribe(c.getInstance().getEventString("DATA_CHANGE"),e.setup.bind(babelHelpers.assertThisInitialized(e)),"new");return e}var d=c.prototype;d.setup=function(a,b){this.appphoto=b.byapp;this.byowner=b.isowner;return this.reset()};d.reset=function(){var c=this,d=this.getTokenElements().map(this.getTokenDataFromTag,this);this.withTagKeys={};var e=this.getWithTagTokenElements().map(function(a){return c._tokenKey(c.getTokenDataFromTag(a))});this.withTagKeys=b("createObjectFrom")(e);return a.prototype.reset.call(this,d)};d.processEvents=function(a,c,d){if(b("Parent").byClass(c,"remove")){d=this.getTokenFromElement(d);d=this.addTokenData(d,c);this.removeToken(d);a.kill()}};d.insertToken=function(a){return null};d.removeToken=function(a){if(this.appphoto)return this.replaceToken(a);else this.inform("removeToken",a),b("Arbiter").inform("Form/change",{node:this.element});return null};d.addTokenData=function(a,c){b("Parent").byClass(c,"blockuser")&&(a.blockUser=!0);return a};d.getTokenDataFromTag=function(a){return{uid:b("DOM").find(a,"input").value,text:b("getElementText")(b("DOM").find(a,".taggee"))}};d.getTokenElementFromTarget=function(a){return b("Parent").byClass(a,"tagItem")};d.getTokenElements=function(){return b("DOM").scry(this.tokenarea,"span.tagItem").filter(this.filterNonTokenElements,this)};d.getWithTagTokenElements=function(){return b("DOM").scry(this.tokenarea,"span.withTagItem")};d.filterNonTokenElements=function(a){return!b("CSS").hasClass(a,"markasspam")&&!b("CSS").hasClass(a,"reported")&&!b("CSS").hasClass(a,"withTagItem")};d.createToken=function(a,c){var d=this.getToken(this._tokenKey(a));d=d||new(b("TagToken"))(a);c&&d.setElement(c);return d};d.updateTokenareaVisibility=function(){var a=this.getTokenElements().filter(function(a){return b("CSS").shown(a)}),c=this.getWithTagTokenElements(),d=b("DOM").scry(this.tokenarea,"span.ogTagItem");b("CSS").conditionShow(this.tokenarea,a.length!==0||c.length!==0||d.length!==0)};d.replaceToken=function(a){__p&&__p();if(!a)return;var c=this.tokens.indexOf(a);if(c<0)return;this.tokens.splice(this.tokens.indexOf(a),1);delete this.unique[this._tokenKey(a.getInfo())];c=b("ge")("tagspam"+a.getValue());c&&b("DOM").remove(c);c=[" [",g._("Marca\u00e7\u00e3o removida")," "];c.push(b("DOM").create("a",{onclick:this.markAsSpam.bind(this,a.getValue())},g._("Denunciar marca\u00e7\u00e3o como spam")));c.push("] ");c=b("DOM").create("span",{className:"fbPhotosTaglistTag tagItem markasspam",id:"tagspam"+a.getValue()},c);b("DOM").replace(a.getElement(),c);this.updateTokenarea();this.inform("removeToken",a);b("Arbiter").inform("Form/change",{node:this.element})};d.markAsSpam=function(a){var c=b("ge")("tagspam"+a),d=[" [",g._("Marca\u00e7\u00e3o reportada"),"] "];d=b("DOM").create("span",{className:"fbPhotosTaglistTag tagItem reported",id:"tagspam"+a},d);b("DOM").replace(c,d);this.inform("markTagAsSpam",a)};d.removeTokenForSpatialTag=function(b){a.prototype.removeToken.call(this,b)};return c}(b("Tokenizer"));e.exports=a}),null);
__d("SphericalPhotoTaggerContainer",["DOM","PhotosConst","PhotoViewer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("PhotosConst").VIEWER_SPHERICAL,h=null;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.container=b("DOM").create("div");return c}var d=c.prototype;d.getVersionConst=function(){return g};d.getEventPrefix=function(){return"SphericalPhotoTagger"};c.getInstance=function(){h||(h=new c());return h};return c}(b("PhotoViewer"));e.exports=a}),null);
__d("SphericalPhotoTaggerInitializer",["DOM","PhotoTagger","SphericalPhotoTaggerContainer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={init:function(a,c,d){var e=b("SphericalPhotoTaggerContainer").getInstance();e.root=b("DOM").create("div");e.stageActions=b("DOM").create("div",{"class":"stageActions"});e.image=e.stageActions;var f=b("DOM").create("div",{"class":"newTagBox"});b("DOM").appendContent(e.stageActions,f);b("DOM").appendContent(e.root,e.stageActions);f=new(b("PhotoTagger"))(e);f.initSphericalPhoto(a,c,d)}};e.exports=a}),null);